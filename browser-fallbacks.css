/* ========================================
   MICROCLEAN - BROWSER FALLBACKS
   Support for older browsers and missing features
   ======================================== */

/* ==================== ASPECT-RATIO FALLBACK ==================== */
/* For browsers that don't support aspect-ratio property */
.no-aspectRatio .image-pair {
    aspect-ratio: auto !important;
    padding-bottom: 56.25%; /* Fallback to padding-bottom hack */
    height: 0;
}

.no-aspectRatio .image-pair.portrait-mobile {
    padding-bottom: 75%; /* 4:3 */
}

.no-aspectRatio .image-pair.landscape-mobile {
    padding-bottom: 42.86%; /* 21:9 */
}

/* ==================== BACKDROP-FILTER FALLBACK ==================== */
/* For browsers that don't support backdrop-filter */
.no-backdropFilter #header {
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
    background: rgba(255, 255, 255, 0.98) !important;
}

.no-backdropFilter .service-card:hover {
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
    background: var(--white) !important;
}

.no-backdropFilter .label {
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
    background: rgba(9, 101, 198, 0.95) !important;
}

/* ==================== POINTER EVENTS FALLBACK ==================== */
/* For browsers without pointer events support */
.no-pointerEvents .slider-wrapper {
    touch-action: pan-y !important;
}

/* ==================== OBJECT-FIT FALLBACK ==================== */
/* For IE11 and older browsers */
@supports not (object-fit: cover) {
    .service-image img,
    .before-image img,
    .after-image img {
        /* Fallback positioning */
        width: 100%;
        height: 100%;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
    }
}

/* ==================== CSS GRID FALLBACK ==================== */
/* For browsers without grid support */
@supports not (display: grid) {
    .services-grid,
    .gallery-grid {
        display: flex;
        flex-wrap: wrap;
        margin: -1rem;
    }

    .service-card,
    .before-after-container {
        flex: 1 1 calc(33.333% - 2rem);
        margin: 1rem;
        min-width: 280px;
    }

    @media (max-width: 1024px) {
        .service-card,
        .before-after-container {
            flex: 1 1 calc(50% - 2rem);
        }
    }

    @media (max-width: 768px) {
        .service-card,
        .before-after-container {
            flex: 1 1 100%;
        }
    }
}

/* ==================== CLIP-PATH FALLBACK ==================== */
/* For browsers without clip-path support */
@supports not (clip-path: inset(0)) {
    .after-image {
        clip-path: none !important;
        /* Use overflow instead */
        overflow: hidden;
        width: 0%;
        transition: width 0.05s ease-out;
    }

    /* This would need JS support to update width instead of clip-path */
    .after-image[data-position] {
        width: var(--slider-position, 0%);
    }
}

/* ==================== CUSTOM PROPERTIES FALLBACK ==================== */
/* For browsers without CSS custom properties */
@supports not (--custom: property) {
    :root {
        /* Define fallback colors directly */
    }

    /* Fallback color values */
    .btn-primary {
        background: linear-gradient(135deg, #0777B6, #0965C6) !important;
        color: white !important;
    }

    #header {
        background: rgba(255, 255, 255, 0.95) !important;
    }

    footer {
        background: linear-gradient(135deg, #0965C6, #0777B6) !important;
    }
}

/* ==================== FLEXBOX FALLBACK FOR OLDER FLEXBOX ==================== */
/* Fix for older flexbox implementations */
.hero-buttons {
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;

    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
    -webkit-flex-direction: row;
    -ms-flex-direction: row;
    flex-direction: row;

    gap: 1rem;
}

/* Gap fallback for flexbox */
@supports not (gap: 1rem) {
    .hero-buttons > * {
        margin-right: 1rem;
    }

    .hero-buttons > *:last-child {
        margin-right: 0;
    }
}

/* ==================== TRANSFORM FALLBACK ==================== */
/* For very old browsers */
@supports not (transform: translateY(-4px)) {
    .service-card:hover,
    .btn-primary:hover {
        margin-top: -4px;
        margin-bottom: 4px;
    }
}

/* ==================== FILTER FALLBACK ==================== */
/* For browsers without filter support */
@supports not (filter: blur(10px)) {
    .footer-logo {
        filter: none !important;
        /* Just show the logo as-is */
        mix-blend-mode: normal !important;
    }
}

/* ==================== POSITION STICKY FALLBACK ==================== */
/* For browsers without sticky support */
@supports not (position: sticky) {
    .carrito-panel {
        position: static !important;
    }
}

/* ==================== SCROLL-BEHAVIOR FALLBACK ==================== */
/* Handled by JavaScript */
@supports not (scroll-behavior: smooth) {
    html {
        /* JavaScript will handle smooth scrolling */
        scroll-behavior: auto;
    }
}

/* ==================== MIN/MAX/CLAMP FALLBACK ==================== */
@supports not (width: clamp(1rem, 5vw, 3rem)) {
    /* Use fixed values instead of fluid typography */
    h1 {
        font-size: 2.5rem !important;
    }

    h2 {
        font-size: 2rem !important;
    }

    @media (max-width: 768px) {
        h1 {
            font-size: 1.75rem !important;
        }

        h2 {
            font-size: 1.5rem !important;
        }
    }
}

/* ==================== INTERSECTION OBSERVER FALLBACK ==================== */
/* For browsers without IntersectionObserver */
.no-intersectionObserver .scroll-reveal {
    /* Show everything immediately */
    opacity: 1 !important;
    transform: translateY(0) !important;
}

/* ==================== MOBILE SAFARI FIXES ==================== */
/* Fix for iOS Safari viewport height issue */
@supports (-webkit-touch-callout: none) {
    .hero {
        min-height: -webkit-fill-available;
    }
}

/* Fix for iOS rubber band scrolling */
body {
    overscroll-behavior-y: none;
    -webkit-overflow-scrolling: touch;
}

/* ==================== PRINT STYLES ==================== */
@media print {
    /* Hide unnecessary elements when printing */
    .whatsapp-fab,
    .menu-toggle,
    .btn-whatsapp-header,
    .slider-handle {
        display: none !important;
    }

    /* Show full images */
    .after-image {
        clip-path: none !important;
    }

    /* Remove animations */
    * {
        animation: none !important;
        transition: none !important;
    }
}

/* ==================== REDUCED MOTION SUPPORT (IMPROVED) ==================== */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }

    .hero-bg,
    .hero::before,
    .hero::after {
        animation: none !important;
    }
}

/* ==================== HIGH CONTRAST MODE ==================== */
@media (prefers-contrast: high) {
    /* Increase contrast for better visibility */
    .btn-primary,
    .service-link {
        border-width: 3px !important;
    }

    .service-card {
        border: 2px solid currentColor !important;
    }
}

/* ==================== DARK MODE SUPPORT (FUTURE-PROOFING) ==================== */
@media (prefers-color-scheme: dark) {
    /* Placeholder for future dark mode implementation */
    /* Currently maintaining light theme only */
}

/* ==================== FORCED COLORS MODE (Windows High Contrast) ==================== */
@media (forced-colors: active) {
    .btn-primary,
    .service-link {
        border: 2px solid ButtonText;
    }

    .whatsapp-fab {
        border: 2px solid ButtonText;
        forced-color-adjust: none;
    }
}
